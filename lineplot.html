<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Time Series Plot</title>
		<script type="text/javascript" src="https://d3js.org/d3.v6.min.js"></script>
		
	</head>
	<body>
		<script type="text/javascript">

			//Width and height
			var width = 1000;
			var height = 600;
            var padding = 40;

            //Create SVG element
            var svg = d3.select("body")
						.append("svg")
						.attr("width", width)
						.attr("height", height);

            //Scales
            var xScale = d3.scaleTime().range([padding, width - padding * 2]);
            var yScale = d3.scaleLinear().range ([height - padding, padding]);

            //Dates Data
            var rowConverter = function(d) {
				return {
					date : d3.timeParse("%Y-%m-%d")(d.date),
                    confirmed: parseInt(d.confirmed),
                    deceased: parseInt(d.deceased),
                    age: parseInt(d.age),
                    sex: d.sex
				}
                ;
			}
            
            var promises = [d3.csv("/data/Time.csv", rowConverter), 
                d3.csv("/data/TimeAge.csv", rowConverter), 
                d3.csv("/data/TimeGender.csv", rowConverter)];
            var myDataPromises = Promise.all(promises);
            
            myDataPromises.then(function(data){
                
                xScale = d3.scaleTime()
							   .domain(d3.extent(data[0], function(d) { return d.date; }))
							   .range([padding, width - padding * 2]);

                yScale = d3.scaleLinear()
							   .domain([
									d3.max(data[0], function(d) { return d.confirmed; }),
                                    d3.min(data[0], function(d) { return d.confirmed; })
								])
							   .range([ padding, height - padding]);
    
                var xAxis = d3.axisBottom()
					.scale(xScale);
                
                var yAxis = d3.axisLeft()
					.scale(yScale);

                svg.append("g")
                    .attr("transform", "translate(0," + (height - padding) + ")")
                    .call(xAxis);

                svg.append("g")
                    .attr("class", "axis")
                    .attr("transform", "translate(" + (padding) + ",0)")
                    .call(yAxis);

                svg.append("path")
                    .datum(data[0])
                    .attr("fill", "none")
                    .attr("stroke", "steelblue")
                    .attr("stroke-width", 1.5)
                    .attr("d", d3.line()
                        .x(function(d) { return xScale(d.date) })
                        .y(function(d) { return yScale(d.confirmed) })
                        )
            });
        
            
		</script>
	</body>
</html>