<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Time Series Plot</title>
		<script type="text/javascript" src="https://d3js.org/d3.v6.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.js"></script>
		
	</head>
	<body>
		<script type="text/javascript">

			//Width and height
			var width = 1000;
			var height = 600;
            var padding = 40;

            //Create SVG element
            var svg = d3.select("body")
						.append("svg")
						.attr("width", width)
						.attr("height", height);


            //Scales
            var xScale = d3.scaleTime().range([padding, width - padding * 2]);
            var yScale = d3.scaleLinear().range ([height - padding, padding]);
            
            // var promises = [d3.csv("/data/ConfirmedData.csv", rowConverter), 
            //     d3.csv("/data/DeceasedData.csv", rowConverter)];
            // var myDataPromises = Promise.all(promises);
            
            // myDataPromises.then(function(data){

               
            // });

            var fill = d3.scaleOrdinal(d3.schemeCategory10);    

            d3.csv("data/wordcounts_total.csv")
            .then((counts) =>{
                var layout = d3.layout.cloud()
                    .size([width-padding, height-padding])
                    .words(counts)
                    .text((d) => d.word)
                    .fontSize((d) => Math.sqrt(d.counts))
                    .on("end", draw);
                

                // svg.append("words")
                //     .data(words)
                //     .enter()
                //     .append()

                layout.start();

                function draw(words) {
                    console.log(words);
                    svg.append("g")
                        .attr("transform", "translate(" + layout.size()[0] / 2 + "," + layout.size()[1] / 2 + ")")
                        .selectAll("text")
                        .data(words)
                        .enter()
                        .append("text")
                        .text((d) => d.text)
                        .style("font-size", (d) => d.size + "px")
                        .style("font-family", (d) => d.font)
                        .style("fill", (d, i) => fill(i))
                        .attr("text-anchor", "middle")
                        .attr("transform", (d) => "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")");
                }

            
            });

        
            
		</script>
	</body>
</html>